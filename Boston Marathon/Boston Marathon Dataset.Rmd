---
title: "Boston Marathon Dataset"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
```{r}
toSeconds <- function(x){
   if (!is.character(x)) stop("x must be a character string of the form H:M:S")
   if (length(x)<=0)return(x)

   unlist(
      lapply(x,
         function(i){
            i <- as.numeric(strsplit(i,':',fixed=TRUE)[[1]])
            if (length(i) == 3) 
               i[1]*3600 + i[2]*60 + i[3]
            else if (length(i) == 2) 
               i[1]*60 + i[2]
            else if (length(i) == 1) 
               i[1]
         }  
      )  
   )  
} 
```
```


```{r}
library(XML)
doc <- readHTMLTable(doc="http://en.wikipedia.org/wiki/List_of_winners_of_the_Boston_Marathon")
m<-data.frame(doc[5])
w<-data.frame(doc[6])
```

```{r}
m1<-subset(m, select = c(NULL.Year, NULL.Time))
w1<-subset(w, select = c(NULL.Year, NULL.Time))
m2<-toSeconds(as.character(m1$NULL.Time))
w2<-toSeconds(as.character(w1$NULL.Time))
m3<-as.Date(m1$NULL.Year, "%Y")
w3<-as.Date(w1$NULL.Year, "%Y")
plot(m3,m2, ylab="Time in secs.", xlab="Year")
points(w3,w2)
lines(spline(m3,m2, n=3), lty=2, col="grey", lwd=2)
lines(spline(w3,w2, n=3), lty=2, col="grey", lwd=2)
lines(lowess(m3,m2), lty=2, col="red", lwd=3)
lines(lowess(w3,w2), lty=2, col="red", lwd=3)
```

